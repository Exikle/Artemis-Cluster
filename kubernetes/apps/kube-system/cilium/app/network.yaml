---
# ------------------------------------------------------------------------------
# 1. IP POOLS (BGP ONLY + VIP)
# ------------------------------------------------------------------------------
# yaml-language-server: $schema=https://kubernetes-schemas.pages.dev/cilium.io/ciliumloadbalancerippool_v2alpha1.json
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  name: bgp-pool
spec:
  blocks:
    - start: "10.10.99.76"
      stop: "10.10.99.85"
  serviceSelector:
    matchLabels:
      lb.ipam.cilium.io/method: bgp

---
apiVersion: cilium.io/v2alpha1
kind: CiliumLoadBalancerIPPool
metadata:
  name: cp-pool
spec:
  blocks:
    - cidr: "10.10.99.104/32"
  serviceSelector:
    matchLabels:
      io.cilium/bgp-control-plane: enabled

# ------------------------------------------------------------------------------
# 2. BGP ADVERTISEMENTS (COMMENTED OUT FOR COMPATIBILITY)
# ------------------------------------------------------------------------------
# Your CRDs are too old for the new v2 advertisement schema.
# Since we are using basic BGP peering, these explicit policies are optional.
# Uncomment these only after upgrading Cilium CRDs to full v1.14+ standard.

# ---
# apiVersion: cilium.io/v2
# kind: CiliumBGPAdvertisement
# metadata:
#   name: bgp-advertisement
# spec:
#   advertisementType: Service
#   service:
#     addresses:
#       - LoadBalancerIP
#   selector:
#     matchLabels:
#       lb.ipam.cilium.io/method: bgp

# ---
# apiVersion: cilium.io/v2
# kind: CiliumBGPAdvertisement
# metadata:
#   name: cp-advertisement
# spec:
#   advertisementType: Service
#   service:
#     addresses:
#       - LoadBalancerIP
#   selector:
#     matchLabels:
#       io.cilium/bgp-control-plane: enabled
