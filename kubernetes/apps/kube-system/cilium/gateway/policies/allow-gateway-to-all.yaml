apiVersion: cilium.io/v2
kind: CiliumClusterwideNetworkPolicy
metadata:
  name: allow-gateway-to-all
spec:
  description: "Allow Cilium Gateway to communicate with all pods in the cluster"
  endpointSelector:
    matchExpressions:
      - { key: k8s:io.kubernetes.pod.namespace, operator: Exists } # Matches everything
  ingress:
    - fromEndpoints:
        - matchLabels:
            app.kubernetes.io/name: cilium-gateway # Matches your Gateway pods
        - matchLabels:
            app: cilium-gateway # Alternative common label
    - fromEntities:
        - cluster # Fallback for some CNI modes
